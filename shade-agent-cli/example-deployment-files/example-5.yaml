# Deploy a pre approved agent
# Use when there exists an agent contract that has approved measurements

# Copy the Docker Compose file for the approved measurements to copied-docker-compose.yaml

environment: TEE
network: mainnet
docker_compose_path: ./copied-docker-compose.yaml

agent_contract: 
  contract_id: example-contract-123.near

  deploy_custom:
    enabled: false
    funding_amount: 8
    delete_key: false

    deploy_from_source:
      enabled: true
      source_path: ./agent-contract
    deploy_from_wasm:
      enabled: false
      wasm_path: ./agent-contract/target/near/shade-contract-template.wasm
    use_global_by_hash:
      enabled: false
      global_hash: 8eHvv9q4eovoUgDXYEduwv3dbcfXkCyPP9TSmhUSxkcm

    init:
      enabled: true
      method_name: new
      args: |
        {
          "requires_tee": <REQUIRES_TEE>,
          "attestation_expiration_time_ms": <7_DAYS>,
          "owner_id": <MASTER_ACCOUNT_ID>,
          "mpc_contract_id": <DEFAULT_MPC_CONTRACT_ID>
        }

approve_measurements:
  enabled: false
  method_name: approve_measurements
  args: |
    {
      "measurements": <MEASUREMENTS>
    }
  # tgas: 30

approve_ppids:
  enabled: false
  method_name: approve_ppids
  args: |
    {
      "ppids": <PPIDS>
    }
  # tgas: 30

build_docker_image:
  enabled: false
  tag: username/my-first-agent
  cache: true
  dockerfile_path: ./Dockerfile

deploy_to_phala:
  enabled: true
  app_name: my-first-agent
  env_file_path: ./.env

whitelist_agent_for_local:
  method_name: whitelist_agent_for_local
  args: |
    {
      "account_id": <AGENT_ACCOUNT_ID>
    }
  # tgas: 30